<!doctype html>
<html lang="en">
    <head>
        <!-- Google Tag Manager -->
        <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-WTDGBVZ');</script>
        <!-- End Google Tag Manager -->
        <meta charset="utf-8">
        <title>Where it all begins Opportunities</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="Site Description Here">
        <link href="css/bootstrap.css" rel="stylesheet" type="text/css" media="all" />
        <link href="css/stack-interface.css" rel="stylesheet" type="text/css" media="all" />
        <link href="css/socicon.css" rel="stylesheet" type="text/css" media="all" />
        <link href="css/lightbox.min.css" rel="stylesheet" type="text/css" media="all" />
        <link href="css/flickity.css" rel="stylesheet" type="text/css" media="all" />
        <link href="css/iconsmind.css" rel="stylesheet" type="text/css" media="all" />
        <link href="css/jquery.steps.css" rel="stylesheet" type="text/css" media="all" />
        <link href="css/theme.css" rel="stylesheet" type="text/css" media="all" />
        <link href="css/custom.css" rel="stylesheet" type="text/css" media="all" />
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:200,300,400,400i,500,600,700%7CMerriweather:300,300i" rel="stylesheet">
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
        <style>
            .btn-apply {
                background: #ff0047;
                color: #ffffff;
            }
        </style>
    </head>
    <body class=" " data-smooth-scroll-offset='180'>
        <!-- Google Tag Manager (noscript) -->
        <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WTDGBVZ"
        height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
        <!-- End Google Tag Manager (noscript) -->
        <a id="start"></a>
        <div class="nav-container ">
            <div class="bar bar--sm visible-xs">
                <div class="container">
                    <div class="row">
                        <div class="col-3 col-md-2">
                            <a href="index.html">
                                <img class="logo logo-dark" alt="logo" src="img/logo-dark.png" />
                                
                            </a>
                        </div>
                        <div class="col-9 col-md-10 text-right">
                            <a href="#" class="hamburger-toggle" data-toggle-class="#menu2;hidden-xs hidden-sm">
                                <i class="icon icon--sm stack-interface stack-menu"></i>
                            </a>
                        </div>
                    </div>
                    <!--end of row-->
                </div>
                <!--end of container-->
            </div>
            <!--end bar-->
            
            <nav id="menu2" class="bar bar-2 hidden-xs bar--transparent bar--absolute" data-scroll-class='90vh:pos-fixed'>
                <div class="container">
                    <div class="row">
                        
                         <div class="col-lg-2 order-lg-1" style="align-content: flex-end">
                            
                                <a href="index.html">
                                <img class="logo logo-light" alt="logo" src="img/logo-light.png" />
                             </a>
                            <!--end module-->
                        </div>
                        
                         <div class="col-lg-2 order-lg-2">
                            
                        </div>
                        
                        
                       
                       <div class="col-lg-8 order-lg-3">
                            <div class="bar__module">
                                <ul class="menu-horizontal text-right">
                                    <li>
                                        <a href="index.html">Home</a>
                                        <!--end dropdown container-->
                                    </li>
                                    <li>
                                        <a href="/index.html#products">Our Programs</a>
                                        <!--end dropdown container-->
                                    </li>
                                    <li>
                                        <a href="about.html">About Egypt</a>
                                        <!--end dropdown container-->
                                    </li>
                                    <li>
                                        <a href="opportunities.html">Opportunities</a>
                                    </li>
                                  
                                
                                </ul>
                                
                            </div>
                           <span id="current_user" style="color: darkturquoise;"></span>
                           
                           
                            <!--end module-->
                        </div>
                       
                        
                    </div>
                    <!--end of row-->
                </div>
                <!--end of container-->
            </nav>
            <!--end bar-->
        </div>
        <div class="main-container">
            <section class="cover imagebg videobg height-80 text-center video-active " data-overlay="2" id="home">
                
                    <video autoplay="" loop="" muted="">
                <source src="video/brand_launch.m4v" type="video/mp4" style="width: 100%">
            </video>
                <div class="background-image-holder">
                    <img alt="image" src="img/brand_backup_bg.png" />
                </div>
                <div class="container pos-vertical-center">
                    <div class="row">
                        <div class="col-md-8">
                           
                            <br />
                            
                            
                        </div>
                    </div>
                    <!--end of row-->
                </div>
                <!--end of container-->
            </section>
            <section class="text-center cta cta-4 space--xxs border--bottom " style="background-image: url(img/static/pattern3.jpg);">
                <div class="container">
                    <div class="row">
                        <div class="col-md-3">
                            <label class="text-white">Select a Product:</label>
                        <div class="input-select">
                            <select id="product_options" onchange="on_product_change();">
                                <option selected="" value="">All Products</option>
                                <option value="1">Global Volunteer</option>
                                <option value="5">Global Entrepreneur</option>
                                <option value="2">Global Talent</option>
                            </select>
                        </div>
                        </div>
                        
                        <div class="col-md-3">
                            <label class="text-white">Select an Office:</label>
                        <div class="input-select">
                            <select id="office_options">
                                <option selected="" value="Default">All Offices</option>
                                
                            </select>
                        </div>
                        </div>
                        <div id="date_div" class="col-md-3">
                        <label class="text-white">Select Date:</label>
                        <div class="input-select">
                            <select id="date_options">
                                <option selected="" value="Default">Any Time</option>
                                
                            </select>
                        </div>
                            
                        </div>
                        
                        <div id="sdg_div" class="col-md-3">
                        <label class="text-white">Select SDG:</label>
                        <div class="input-select">
                            <select id="sdg_options">
                                <option selected="" value="Default">All SDGs</option>
                                
                            </select>
                        </div>
                            
                        </div>
                        
                        <div id="subproduct_div" class="col-md-3">
                        
                            <label class="text-white">Select Field:</label>
                            <div class="input-select">
                                <select id="subproducts_options">
                                    <option selected="" value="Default">All Fields</option>

                                </select>
                            </div>
                        </div>
                        
                        <div class="col-md-2">
                            <br />
                        <a class="btn btn--sm btn--primary" onclick="filter_opps();"><span class="btn__text">Search</span></a>
                        </div>
                        
                        
                    </div>
                    <!--end of row-->
                </div>
                <!--end of container-->
            </section>
            <section>
                <div class="container">
                    
                    
                    <div class="masonry">
                        
                            <div class="row" id="Opportunities_container">
                                
                                
                            </div>
                            
                            
                            
                           
                        
                        <!--end of masonry__container + row-->
                    </div>
                    
                    
                    <!--end of row-->
                </div>
                <!--end of container-->
            </section>

            
            
            
            <footer class="footer-6 unpad--bottom bg--primary cta cta-2 ">
                <div class="container">
                    
                            <h6 class="type--uppercase text-center">AIESEC</h6>
                            <p>
                                AIESEC is a non-governmental not-for-profit organisation in consultative status with the United Nations Economic and Social Council (ECOSOC), affiliated with the UN DPI, member of ICMYO, and is recognized by UNESCO. AIESEC International is registered as a Foundation (Stichting), RSIN #807103895 in Rotterdam, The Netherlands.
                            </p>
                    
                    <!--end of row-->
                </div>
                <!--end of container-->
                <div class="footer__lower text-center-xs">
                    <div class="container">
                        <div class="row">
                            <div class="col-md-6">
                                <span class="type--fine-print">&copy;
                                    <span class="update-year"></span> AIESEC in Egypt &mdash; All Rights Reserved</span>
                            </div>
                            <div class="col-md-6 text-right text-center-xs">
                                <ul class="social-list list-inline">
                                    
                                    <li>
                                        <a href="https://www.facebook.com/fortheloveofegypt2014/">
                                            <i class="socicon socicon-facebook icon icon--xs"></i>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="https://www.instagram.com/whereitallbeginseg/">
                                            <i class="socicon socicon-instagram icon icon--xs"></i>
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <!--end of row-->
                    </div>
                    <!--end of container-->
                </div>
            </footer>
        </div>
        <div class="all-page-modals">
            <div id="modal_login" class="modal-container" data-modal-index="0">
                                    <div class="modal-content section-modal">
                                        <section class="unpad ">
                                            <div class="container">
                                                <div class="row justify-content-center">
                                                    <div class="col-md-6 col-12">
                                                        div class="feature feature-1">
                                                            <div class="feature__body boxed boxed--lg boxed--border text-center">
                                                                <div class="modal-close modal-close-cross"></div>
                                                                <div class="text-block">
                                                                    <h3>Login to your aiesec.org account</h3>
                                                                    <p>
                                                                        Welcome back, sign in with your existing account credentials.
                                                                    </p>
                                                                </div>
                                                                <p style="color: red;"><span id="login_error_msg"></span></p>
                                                                    <div class="row">
                                                                        <div class="col-md-12">
                                                                            <input id="email_field" type="text" placeholder="Email" />
                                                                        </div>
                                                                </div>
                                                                <br>
                                                                <div class="row">
                                                                        <div class="col-md-12">
                                                                            <input id="password_field" type="password" placeholder="Password" />
                                                                        </div>
                                                                </div>
                                                                <br>
                                                                <div class="row">
                                                                        <div class="col-md-12">
                                                                            <button class="btn btn--primary type--uppercase" onclick="login();">  &#160;&#160;&#160;&#160;&#160;&#160; Sign In &#160;&#160;&#160;&#160;&#160;&#160;  </button>
                                                                        </div>
                                                                    </div>
                                                                
                                                                    <!--end of row-->
                                                                
                                                                <span class="type--fine-print block">Dont have an account yet? <b>Create an account and Sign in here!</b>
                                                                    <br />
                                                                    <button id="goRegister" class="btn btn--primary type--uppercase">Create Account</button>
                                                                </span>
                                                                <span class="type--fine-print block">We do not store passwords.
                                                                    
                                                                </span>
                                                            </div>
                                                        </div>
                                                        <!--end feature-->
                                                    </div>
                                                </div>
                                                <!--end of row-->
                                            </div>
                                            <!--end of container-->
                                        </section>
                                    </div>
                                </div>
            <div id="opp_modal" class="modal-container" data-modal-index="1">
                 <div class="modal-content section-modal">
                                        <section class="unpad ">
                                            <div class="container">
                                                
                                                <div class="row justify-content-center">
                                                    <div class="col-md-12 col-12">
                                                        <section class="cover height-40 imagebg border--round text-center" data-overlay="2">
                                                    <div id="opp_main_cover" class="background-image-holder">
                                                
                                                        <div class="overlay"></div>
                                            </div>
                                                            <div class="pl-5">
                                                                
                                                                <h2 style="margin-bottom: 0px;"><b><span id="opp_title"></span></b></h2>
                                                                <h4 style="margin-top: 0px;"><b><span id="opp_location"></span></b></h4>
                                                                
                                                                
                                                                    
                                                                <span id="apply_button"></span>
                                                              
                                                                
                                                                 <a id="success_btn" class="btn btn-success type--uppercase" style="display: none;"><span class="btn__text">Applied</span></a>
                                                            </div>
                                                </section>
                                                        <div class="feature feature-1 text-center">
                                            
                                                            <div class="feature__body boxed boxed--lg boxed--border">
                                                                <div class="modal-close modal-close-cross"></div>
                                                                <div class="text-block">
                                                                    <p style="color: red"><span id="apply_error_text"></span></p>
                                                                    <p style="color: green"><span id="apply_success_text"></span></p>
                                                                    <div class="tabs-container tabs--vertical" data-content-align="left">
                                                                
                                <ul class="tabs">
                                    <li class="active">
                                        <div class="tab__title">
                                            <span class="h5">Overview</span>
                                        </div>
                                        
                                    </li>
                                    <li class="">
                                        <div class="tab__title">
                                            <span class="h5">Role</span>
                                        </div>
                                        
                                    </li>
                                    <li class="">
                                        <div class="tab__title">
                                            <span class="h5">Requirements</span>
                                        </div>
                                        
                                    </li>
                                    <li class="">
                                        <div class="tab__title">
                                            <span class="h5">Logistics</span>
                                        </div>
                                        
                                    </li>
                                    <li class="">
                                        <div class="tab__title">
                                            <span class="h5">Visa</span>
                                        </div>
                                        
                                    </li>
                                </ul><ul class="tabs-content">
                                    <li class="active">
                            <div class="tab__content">
                                <div class="col-9">
                                        <table class="table table-hover">
                                          <thead>

                                          </thead>
                                          <tbody>
                                            <tr>
                                              <th scope="row">Title</th>
                                              <td><span id="opp_title_details"></span></td>
                                            </tr>
                                            <tr>
                                              <th scope="row">Start Date</th>
                                              <td><span id="opp_start_date"></span></td>
                                            </tr>
                                            <tr>
                                              <th scope="row">End Date</th>
                                              <td><span id="opp_end_date"></span></td>
                                            </tr>
                                               <tr>
                                              <th scope="row">Duartion</th>
                                                   <td><span id="opp_duration"></span> weeks</td>
                                            </tr>
                                               <tr>
                                              <th scope="row">Project Fees</th>
                                              <td><span id="opp_tnfees"></span></td>
                                            </tr>
                                              
                                          </tbody>
                                        </table>
                                    </div>
                                
                                
                                  
                            </div>
                                    </li>
                                    <li class="">
                                        <div class="tab__content">
                                            
                                            <h4>Role description</h4>
                                            <span style="color: black;" id="role_descr"></span>
                                            
                                            <br />
                                            <br />
                                            <h4>Main Activities</h4>
                                            <ul style="color: black;" id="main_activities" style="list-style-type:disc;">
                                            </ul>
                                            
                                        </div>
                                    </li>
                                        <li class="">
                                            <div class="tab__content">
                                                
                                                <div class="col-9">
                                        <table class="table table-hover">
                                          <thead>

                                          </thead>
                                          <tbody>
                                            <tr>
                                              <th scope="row">Backgrounds</th>
                                              <td><span id="opp_backgrounds"></span></td>
                                            </tr>
                                            <tr>
                                              <th scope="row">Skills</th>
                                              <td><span id="opp_skills"></span></td>
                                            </tr>
                                            <tr>
                                              <th scope="row">Citizenships</th>
                                              <td><span id="opp_citizenships"></span></td>
                                            </tr>
                                               <tr>
                                              <th scope="row">Languages</th>
                                                   <td><span id="opp_languages"></span></td>
                                            </tr>
                                               <tr>
                                              <th scope="row">Study Levels</th>
                                              <td><span id="opp_study_levels"></span></td>
                                            </tr>
                                              
                                          </tbody>
                                        </table>
                                    </div>
                                            
                                        </div>
                                            </li>
                                        
                                    <li class="">
                                        <div class="tab__content">
                                            <div class="col-9">
                                        <table class="table table-hover">
                                          <thead>

                                          </thead>
                                          <tbody>
                                            <tr>
                                              <th scope="row">Working Hours</th>
                                              <td><span id="opp_working_hours"></span></td>
                                            </tr>
                                            <tr>
                                              <th scope="row">Computer Provided</th>
                                              <td><span id="opp_computer_provided"></span></td>
                                            </tr>
                                            <tr>
                                              <th scope="row">Accomodation Provided</th>
                                              <td><span id="opp_accom_provided"></span></td>
                                            </tr>
                                               <tr>
                                              <th scope="row">Accomodation Covered</th>
                                                   <td><span id="opp_accom_covered"></span> </td>
                                            </tr>
                                               <tr>
                                              <th scope="row">Food Covered</th>
                                                   <td><span id="opp_food_covered"></span> </td>
                                            </tr>
                                              
                                          </tbody>
                                        </table>
                                    </div>
                                            
                                            
                                        </div></li>
                                                                        
                                                                        
                                    <li class="">
                                        <div class="tab__content">
                                            <div class="col-9">
                                        <table class="table table-hover">
                                          <thead>

                                          </thead>
                                          <tbody>
                                            <tr>
                                              <th scope="row">Visa Type</th>
                                              <td><span id="opp_visa_type"></span></td>
                                            </tr>
                                            <tr>
                                              <th scope="row">Visa Duration</th>
                                              <td><span id="opp_visa_duration"></span></td>
                                            </tr>
                                            <tr>
                                              <th scope="row">Visa Link</th>
                                              <td><span id="opp_visa_link"></span></td>
                                            </tr>
                                               <tr>
                                              <th scope="row">Health Insurance</th>
                                                   <td><span id="opp_health_insurance"></span> </td>
                                            </tr>
                                               
                                              
                                          </tbody>
                                        </table>
                                    </div>
                                            
                                            
                                        </div></li>
                                        </ul>
                            </div>
                                                                    
                                                                    
                                                                </div>
                                                                
                                                            </div>
                                                        </div>
                                                        <!--end feature-->
                                                    </div>
                                                </div>
                                                <!--end of row-->
                                            </div>
                                            <!--end of container-->
                                        </section>
                                    </div>
            </div>
            
            
            
            
        </div>
        
                <a id="trigger_btn" class="btn" href="#" data-notification-link="trigger" style="display: none;">
            <span class="btn__text">
                Trigger Notification
            </span>
        </a>
        <div class="notification pos-right pos-bottom col-md-4 col-lg-3" data-animation="from-bottom" data-notification-link="trigger">
                                <div class="boxed boxed--border border--round">
                                   
                                    <div class="text-block">
                                        
                                        <p>
                                            <span id="notification_text"></span>
                                        </p>
                                    </div>
                                </div>
                            <div class="notification-close-cross notification-close"></div></div>
        
        <!--<div class="loader"></div>-->
        <a class="back-to-top inner-link" href="#start" data-scroll-class="100vh:active">
            <i class="stack-interface stack-up-open-big"></i>
        </a>
        <script src="https://code.jquery.com/jquery-3.4.1.js"></script>
        <script>
            var endpoint = "http://alpha.aiesec.org.eg"
            var loading_opps = false;
            var more_opps_available = true;
            function prettify_booleans(input){
                if (input == true)
                    return "Yes"
                else
                    return "No"
            }
            function show_opp(data)
            {  
                try{document.getElementById('apply_btn').style.display = "inline";}catch{}
                document.getElementById('success_btn').style.display = 'none';
                // Show Overview Tab
                document.getElementById('opp_title').innerHTML = data['data']['getOpportunity']['title'];
                document.getElementById('opp_location').innerHTML = data['data']['getOpportunity']['location'];
                document.getElementById('opp_title_details').innerHTML = data['data']['getOpportunity']['title'];
                document.getElementById('opp_start_date').innerHTML = data['data']['getOpportunity']['earliestStartDate'];
                document.getElementById('opp_end_date').innerHTML = data['data']['getOpportunity']['latestEndDate'];
                document.getElementById('opp_duration').innerHTML = data['data']['getOpportunity']['duration'];
                document.getElementById('opp_tnfees').innerHTML = data['data']['getOpportunity']['TNFee'] + data['data']['getOpportunity']['TNFeeCurrency'];
                
                document.getElementById('opp_main_cover').setAttribute('style', 'background: url(" ' + data['data']['getOpportunity']['coverPhoto'] +  ' "); opacity: 1;' );
                // Role Tab
                document.getElementById('role_descr').innerHTML = data['data']['getOpportunity']['opportunityRole']['roleDescription'];
                document.getElementById('main_activities').innerHTML = ""
                var activities = data['data']['getOpportunity']['opportunityRole']['mainActivities'];
                activities.forEach(function(element) {
                    document.getElementById('main_activities').innerHTML += '<li>' + element.description + '</li>';
                });
                
                // Prerequisites Tab
                document.getElementById('opp_backgrounds').innerHTML = "";
                document.getElementById('opp_skills').innerHTML = "";
                document.getElementById('opp_citizenships').innerHTML = "";
                document.getElementById('opp_languages').innerHTML = "";
                document.getElementById('opp_study_levels').innerHTML = "";
                
                var backgrounds = data['data']['getOpportunity']['opportunityPrerequisites']['backgrounds'];
                backgrounds.forEach(function(element) {
                    document.getElementById('opp_backgrounds').innerHTML += element.name + ', '
                });
                
                var skills = data['data']['getOpportunity']['opportunityPrerequisites']['skills'];
                skills.forEach(function(element) {
                    document.getElementById('opp_skills').innerHTML += element.name + ', '
                });
                
                var citizenships = data['data']['getOpportunity']['opportunityPrerequisites']['citizenships'];
                citizenships.forEach(function(element) {
                    document.getElementById('opp_citizenships').innerHTML += element.name + ', '
                });
                
                var languages = data['data']['getOpportunity']['opportunityPrerequisites']['languages'];
                languages.forEach(function(element) {
                    document.getElementById('opp_languages').innerHTML += element.name + ', '
                });
                
                var studylevels = data['data']['getOpportunity']['opportunityPrerequisites']['studyLevels'];
                studylevels.forEach(function(element) {
                    document.getElementById('opp_study_levels').innerHTML += element.name + ', '
                });
                
                
                // Logistics Tab
                document.getElementById('opp_working_hours').innerHTML = 'From ' + data['data']['getOpportunity']['opportunityLogistics']['workingHoursFrom'] + ' To ' + data['data']['getOpportunity']['opportunityLogistics']['workingHoursTo'];
                
                document.getElementById('opp_computer_provided').innerHTML = prettify_booleans(data['data']['getOpportunity']['opportunityLogistics']['computerProvided']);
                
                document.getElementById('opp_accom_provided').innerHTML = prettify_booleans(data['data']['getOpportunity']['opportunityLogistics']['accommodationProvided']);
                
                document.getElementById('opp_accom_covered').innerHTML = prettify_booleans(data['data']['getOpportunity']['opportunityLogistics']['accommodationCovered']);
                
                document.getElementById('opp_food_covered').innerHTML = prettify_booleans(data['data']['getOpportunity']['opportunityLogistics']['foodCovered']);
                
                // Visa Tab
                document.getElementById('opp_visa_type').innerHTML = data['data']['getOpportunity']['opportunityVisa']['visaType'];
                document.getElementById('opp_visa_duration').innerHTML = data['data']['getOpportunity']['opportunityVisa']['visaDuration'];
                document.getElementById('opp_visa_link').innerHTML = data['data']['getOpportunity']['opportunityVisa']['visaLink'];
                document.getElementById('opp_health_insurance').innerHTML = data['data']['getOpportunity']['opportunityVisa']['insurance'];
                
                
                
                // Show the Modal
                document.getElementById('opp_modal').setAttribute('class', 'modal-container modal-active');
                //console.log(data);
            }
            function load_opp(opp_id)
            {
                document.getElementById('apply_error_text').innerHTML = "";
                document.getElementById('apply_success_text').innerHTML = "";
                var query = `query Myquery($id: ID!) {
                  
                      getOpportunity(id:$id)
                      {
                        expaId
                        coverPhoto
                        TNFee
                        TNFeeCurrency
                        product
                        {
                          name
                        }
                        project
                        {
                          name
                        }
                        title
                        location
                        earliestStartDate
                        latestEndDate
                        applicationCloseDate
                        duration
                        opportunityRole
                        {
                          roleDescription
                          mainActivities
                          {
                            description
                          }
                          sdg
                          {
                            name
                            expaId
                          }
                        }
                        opportunityLogistics
                        {
                          workingHoursFrom
                          workingHoursTo
                          computerProvided
                          accommodationProvided
                          accommodationCovered
                          foodCovered
                          city
                          {
                            name
                          }
                          salary
                          salaryCurrency
                        }

                        opportunityPrerequisites
                        {
                          backgrounds
                          {
                            name
                          }
                          skills
                          {
                            name
                          }
                          citizenships
                          {
                            name
                          }
                          languages
                          {
                            name
                          }
                          studyLevels
                          {
                            name
                          }
                        }

                        opportunityVisa
                        {
                          visaType
                          visaDuration
                          visaLink
                          insurance
                        }

                        hostLc
                        {
                          name
                        }
                      }
                    
                }`;
                
                var variables = { id: opp_id },

                data_ = fetch(endpoint + '/graphql', {
                  method: 'POST',
                  headers: {
                    'Content-Type': 'application/json',
                    'Accept': 'application/json',
                  },
                  body: JSON.stringify({
                    query,
                    variables,
                  })
                })
                  .then(r => r.json())
                  .then(data => show_opp(data));
                //console.log(opp_id);
                try{document.getElementById('apply_btn').setAttribute('onclick', 'apply_for("'+ opp_id+ '");')}catch{}
            }
            function close(data){
                
                var cursor = data['data']['allOpportunities']['pageInfo']['endCursor'];
                document.getElementById('Opportunities_container').setAttribute('cursor', cursor);
                if (data['data']['allOpportunities']['pageInfo']['hasNextPage'] == false)
                    more_opps_available = false;
                var opportunities = data['data']['allOpportunities']['edges'];
                
                if (opportunities.length > 0){
                    opportunities.forEach(function(element) {
                      //console.log(element['node'].title);


                        var $log = $( "#Opportunities_container" ),
                        str = '<div class="col-md-4 masonry__item"> <div class="card card-2 boxed--sm boxed--border text-center"> <div class="card__top" style="height: 198px;"> <a onClick="load_opp(' + "'" +element['node'].id+ "'" + ');"><img style="height: 100%; width: 100%; object-fit: cover;" alt="Image" src="'+ element['node'].coverPhoto +'"> </a></div><div class="card__body text-white" style="background-image: url(img/static/pattern2.jpg);" > <h4 style="color: white;">'+ element['node'].title+'</h4> <span style="color: white;">'+ element['node']['hostLc'].name +'</span> <p style="text-align: left;">Starting '+ element['node'].earliestStartDate +', '+ element['node'].duration +' weeks, '+ element['node'].location +' </p><p style="text-align: right;"><span id="apply_id'+element['node'].expaId+'"></span></p></div></div></div>',
                        html = $.parseHTML( str ),
                        nodeNames = [];
                        $log.append( html );

                        my_link = document.getElementById('apply_id' + element['node'].expaId);
                        my_link.innerHTML = '<a id="'+ element['node'].expaId+'" class="btn btn--xs btn-apply type--uppercase" onClick="load_opp(' + "'" +element['node'].id+ "'" + ');"> <span style="color: white;"> Apply </span> </a>'

                        //document.getElementById("Opportunities_container").
                  //modal-trigger" href="#" data-modal-index="0"

                    });
                    loading_opps = false;
                }
               else{
                   document.getElementById('Opportunities_container').innerHTML = '<div class="row text-center"><div class="col-lg-12"><h3>No opportunities match your filters, please change them and try again!</h3</div></div>'
                }
               
            }
            
            function fetch_opps(u_product, u_host_lc, u_sdg, u_subproduct,u_date,u_after)
            {
                //console.log(u_date)
                var query = `query MyQuery($product: ID, $hostLC: ID, $sdg: Float, $subproduct: Float,$date: ID, $after: String){
                  allOpportunities(product_ExpaId:$product,hostLc_ExpaId:$hostLC,opportunityRole_Sdg_ExpaId: $sdg,opportunityRole_SubProduct_ExpaId:$subproduct,isIcxMarketing: true,availabilities_Id:$date, first:3, after: $after)
                  {
                    pageInfo
                    {
                      hasNextPage
                      startCursor
                      endCursor
                    }
                    edges
                    {
                      node
                      {
                        id
                        expaId
                        title
                        earliestStartDate
                        latestEndDate
                        duration
                        applicationCloseDate
                        location
                        hostLc
                        {
                          name
                        }
                        product
                        {
                          id
                          name
                        }
                        coverPhoto
                      }
                    }
                  }
                }`;
                
                var variables = { product: u_product,
                                  hostLC: u_host_lc,
                                  sdg: u_sdg,
                                  subproduct: u_subproduct,
                                  date: u_date,
                                  after: u_after},

                data_ = fetch(endpoint + '/graphql', {
                  method: 'POST',
                  headers: {
                    'Content-Type': 'application/json',
                    'Accept': 'application/json',
                  },
                  body: JSON.stringify({
                    query,
                    variables
                  })
                })
                  .then(r => r.json())
                  .then(data => close(data));
                //console.log(data_);
            }
            
            function inject_offices(data)
            {
                var offices = data['data']['allEntities']['edges'];
                offices.forEach(function(element) {
                    var $log = $( "#office_options" ),
                    str = '<option value="' + element['node'].expaId + '">' + element['node'].name + '</option>',
                    html = $.parseHTML( str ),
                    nodeNames = [];
                    $log.append( html );
                });
            }
            
            function inject_sdgs(data)
            {
                var sdgs = data['data']['allSdgs']['edges'];
                sdgs.forEach(function(element) {
                    var $log = $( "#sdg_options" ),
                    str = '<option value="' + element['node'].expaId + '">' + element['node'].name + '</option>',
                    html = $.parseHTML( str ),
                    nodeNames = [];
                    $log.append( html );
                });
            }
            
            function inject_subproducts(data)
            {
                var subproducts = data['data']['allSubproducts']['edges'];
                subproducts.forEach(function(element) {
                    var $log = $( "#subproducts_options" ),
                    str = '<option value="' + element['node'].expaId + '">' + element['node'].name + '</option>',
                    html = $.parseHTML( str ),
                    nodeNames = [];
                    $log.append( html );
                });
            }
            
            
            function fetch_subproducts()
            {
                var query = `query Myquery {
                 allSubproducts
                  {
                    edges
                    {
                      node
                      {
                        expaId
                        name
                      }
                    }
                  }
                }`;

                data_ = fetch(endpoint + '/graphql', {
                  method: 'POST',
                  headers: {
                    'Content-Type': 'application/json',
                    'Accept': 'application/json',
                  },
                  body: JSON.stringify({
                    query,
                  })
                })
                  .then(r => r.json())
                  .then(data => inject_subproducts(data));
                //console.log(data_);
            }
            
            
            function fetch_sdgs()
            {
                var query = `query Myquery {
                 allSdgs
                  {
                    edges
                    {
                      node
                      {
                        id
                        name
                        expaId
                        description
                      }
                    }
                  }
                }`;

                data_ = fetch(endpoint + '/graphql', {
                  method: 'POST',
                  headers: {
                    'Content-Type': 'application/json',
                    'Accept': 'application/json',
                  },
                  body: JSON.stringify({
                    query,
                  })
                })
                  .then(r => r.json())
                  .then(data => inject_sdgs(data));
                //console.log(data_);
            }
            
            
            function fetch_offices()
            {
                var query = `query Myquery {
                 allEntities
                  {
                    edges
                    {
                      node
                      {
                        id
                        expaId
                        name
                      }
                    }
                  }
                }`;

                data_ = fetch(endpoint + '/graphql', {
                  method: 'POST',
                  headers: {
                    'Content-Type': 'application/json',
                    'Accept': 'application/json',
                  },
                  body: JSON.stringify({
                    query,
                  })
                })
                  .then(r => r.json())
                  .then(data => inject_offices(data));
                //console.log(data_);
            }
            
            
            function listCookies() {
            var theCookies = document.cookie.split(';');
            var aString = '';
            for (var i = 1 ; i <= theCookies.length; i++) {
                aString += i + ' ' + theCookies[i-1] + "\n";
            }
            return aString;
        }
            
            function getCookie(cname) {
              var name = cname + "=";
              var decodedCookie = decodeURIComponent(document.cookie);
              var ca = decodedCookie.split(';');
              for(var i = 0; i <ca.length; i++) {
                var c = ca[i];
                while (c.charAt(0) == ' ') {
                  c = c.substring(1);
                }
                if (c.indexOf(name) == 0) {
                  return c.substring(name.length, c.length);
                }
              }
              return "";
            }

            function setCookie(cname, cvalue, exdays) {
              var d = new Date();
              d.setTime(d.getTime() + (exdays*24*60*60*1000));
              var expires = "expires="+ d.toUTCString();
              document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
            }    

            function validate_login(data)
            {
                //console.log(data);
                if (data['data']['expaLogin'] != null)
                {
                    setCookie("alpha_token", data['data']['expaLogin']['token'], 1);
                    location.reload();
                }
                else
                {
                    $('#modal_login *').prop("disabled", false);
                    document.getElementById('login_error_msg').innerHTML = "Wrong Username or Password!"
                }
            }

            function logout()
            {
                document.cookie = "alpha_token=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";
                location.reload();
            }


            function login()
            {
                $("#modal_login *").attr("disabled", "disabled").off('click');
                var query = `mutation Mymutation($email: String!, $password: String!) {

                      expaLogin(email:$email,password:$password, type:"ICX")
                      {
                        user
                        {
                          profile
                          {
                            firstName
                          }
                        }
                        token
                      }

                    }`;

                    var variables = { email: document.getElementById('email_field').value,
                                      password: document.getElementById('password_field').value},

                    data_ = fetch(endpoint + '/graphql', {
                      method: 'POST',
                      headers: {
                        'Content-Type': 'application/json',
                        'Accept': 'application/json',
                      },
                      body: JSON.stringify({
                        query,
                        variables,
                      })
                    })
                      .then(r => r.json())
                      .then(data => validate_login(data));

            }

            function show_user_data(data)
            {
                document.getElementById('current_user').innerHTML = 'Hello, ' + data['data']['currentuser']['profile']['firstName'] + ', ' + '<a href="#" style="color: white;" onclick="logout();">Logout</a>';

            }
            
            function get_current_user(access_token)
            {
                var query = `query Myquery {
                     currentuser
                      {
                        id
                        profile
                        {
                          firstName
                        }
                      }
                    }`;

                    data_ = fetch(endpoint + '/graphql', {
                      method: 'POST',
                      headers: {
                        'Content-Type': 'application/json',
                        'Accept': 'application/json',
                        'Authorization': 'JWT ' + access_token,
                      },
                      body: JSON.stringify({
                        query,
                      })
                    })
                      .then(r => r.json())
                      .then(data => show_user_data(data));
            }
            function show_login_panel()
            {
                document.getElementById('opp_modal').setAttribute('class', 'modal-container')
                document.getElementById('modal_login').setAttribute('class', 'modal-container modal-active')
            }
            
            function getUrlVars() {
                var vars = {};
                var parts = window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi, function(m,key,value) {
                    vars[key] = value;
                });
                return vars;
            }
            
            function getUrlParam(parameter, defaultvalue){
                var urlparameter = defaultvalue;
                if(window.location.href.indexOf(parameter) > -1){
                    urlparameter = getUrlVars()[parameter];
                    }
                return urlparameter;
            }
            
            function on_product_change()
            {
                var sdgs = document.getElementById("sdg_div");
                var subproducts = document.getElementById("subproduct_div");
                var product_options = document.getElementById('product_options')
                var product = product_options.options[product_options.selectedIndex].value;
                if (product == "1")
                {
                    sdgs.style.display = "block";
                    subproducts.style.display = "none";
                }
                else if (product == "2" || product == "5")
                {
                    sdgs.style.display = "none";
                    subproducts.style.display = "block";
                }
                else
                {
                    sdgs.style.display = "none";
                    subproducts.style.display = "none";
                }
            }
            
            function filter_opps()
            {
                var product_options = document.getElementById('product_options')
                var office_options = document.getElementById('office_options')
                var sdg_options = document.getElementById('sdg_options')
                var subproduct_options = document.getElementById('subproducts_options')
                var dates_options = document.getElementById("date_options");
                
                var product = product_options.options[product_options.selectedIndex].value;
                var office = office_options.options[office_options.selectedIndex].value;
                var sdg = sdg_options.options[sdg_options.selectedIndex].value;
                var subproduct = subproduct_options.options[subproduct_options.selectedIndex].value;
                var date = dates_options.options[dates_options.selectedIndex].value;
                
                url= "http://whereitallbegins.org/opportunities.html?"
                
                if (product != "")
                {
                    url += "product=" + product.toString() + "&";
                }
                if (office != "Default")
                {
                    url += "office=" + office.toString() + "&";
                }
                if (sdg != "Default")
                {
                    url += "sdg=" + sdg.toString() + "&";
                }
                if (subproduct != "Default")
                {
                    url += "subproduct=" + subproduct.toString();
                }
                if (date != "")
                url += "date=" + date
                //console.log(url);
                
                window.location.href = url;
            }
            
            function inject_availabilities(data)
            {
                var sdgs = data['data']['allAvailabilities']['edges'];
                sdgs.forEach(function(element) {
                    var $log = $( "#date_options" ),
                    str = '<option value="' + element['node'].id + '">' + element['node'].name + '</option>',
                    html = $.parseHTML( str ),
                    nodeNames = [];
                    $log.append( html );
                });
            }
            
            function fetch_availabilities()
            {
            var query = `query Myquery {
              allAvailabilities(orderBy:"available_from")
              {
                edges
                {
                  node
                  {
                    id
                    name
                  }
                }
              }
            }`;

            data_ = fetch(endpoint + '/graphql', {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json',
                'Accept': 'application/json',
              },
              body: JSON.stringify({
                query,
              })
            })
              .then(r => r.json())
              .then(data => inject_availabilities(data));
            //console.log(data_);
        }
            
            function fetch_more_opps()
            {
                var after = document.getElementById('Opportunities_container').getAttribute('cursor');
                var product = getUrlParam("product", "");
                var host_lc = getUrlParam("office", "");
                var sdg = getUrlParam("sdg", null);
                var subproduct = getUrlParam("subproduct",null);
                var date = getUrlParam("date",null);
                //console.log(after);
                fetch_opps(product, host_lc, sdg, subproduct, date, after);

                
            }
            
            
            function validate_apply(data){
                if (data['data']['createApplication'] == null)
                    {
                        document.getElementById('apply_error_text').innerHTML = data['errors'][0]['message'];
                    }
                else
                    {
                        //document.getElementById('opp_modal').setAttribute('class', 'modal-container')
                        document.getElementById('apply_success_text').innerHTML = "Thank you for applying, we have recieved your application and will be contacting you very soon!";
                        document.getElementById('apply_btn').style.display = "none";
                        document.getElementById('success_btn').style.display = 'inline';
                        //$('#trigger_btn').click();
                    }   
                document.getElementById('apply_button').style.display = "inline";
            }
            
            function apply_for(opp_id){
                
                var apply_btn = document.getElementById('apply_button')
                apply_btn.style.display = "none";
                document.getElementById('apply_error_text').innerHTML = "";
                document.getElementById('apply_success_text').innerHTML = "";
                var current_token = getCookie('alpha_token');
                var query = `mutation myMutation($opp_id: String!)
                {
                  createApplication(opportunityId:$opp_id)
                  {
                    application
                    {
                      id
                      visitor
                      {
                        username
                      }
                      createdAt
                      opportunity
                      {
                        title
                      }
                    }
                  }
                }`;

                    var variables = { opp_id: opp_id }

                    data_ = fetch(endpoint + '/graphql', {
                      method: 'POST',
                      headers: {
                        'Content-Type': 'application/json',
                        'Accept': 'application/json',
                        'Authorization': 'jwt ' + current_token
                      },
                      body: JSON.stringify({
                        query,
                        variables,
                      })
                    })
                      .then(r => r.json())
                      .then(data => validate_apply(data));

            }
            function main()
                {   
                var product = getUrlParam("product", "");
                var host_lc = getUrlParam("office", "");
                var sdg = getUrlParam("sdg", null);
                var subproduct = getUrlParam("subproduct",null);
                var date = getUrlParam("date",null);

                fetch_sdgs();
                fetch_offices();
                fetch_subproducts();
                fetch_availabilities();
                fetch_opps(product, host_lc, sdg, subproduct, date, "");


                var product_options = document.getElementById('product_options')
                var office_options = document.getElementById('office_options')
                var sdg_options = document.getElementById('sdg_options')
                var subproduct_options = document.getElementById('subproducts_options')
                
                var opts = product_options.options;
                  for (var opt, j = 0; opt = opts[j]; j++) {
                    if (opt.value == product) {
                      product_options.selectedIndex = j;
                      break;
                    }
                  }
                var opts = office_options.options;
                  for (var opt, j = 0; opt = opts[j]; j++) {
                    if (opt.value == host_lc) {
                      office_options.selectedIndex = j;
                      break;
                    }
                  }
                
                
                var opts = sdg_options.options;
                  for (var opt, j = 0; opt = opts[j]; j++) {
                      //console.log(opt.value);
                    if (opt.value == sdg) {
                      sdg_options.selectedIndex = j;
                      break;
                    }
                  }
                
                var opts = subproduct_options.options;
                  for (var opt, j = 0; opt = opts[j]; j++) {
                    if (opt.value == subproduct) {
                      subproduct_options.selectedIndex = j;
                      break;
                    }
                  }
                
                on_product_change();
                    
                    
                    var current_token = getCookie('alpha_token');
                    if (current_token == "")
                    {
                        //console.log('Adding Sign in Button');
                        var $log = $( "#current_user"),
                        str = '<a class="btn btn--sm btn--primary type--uppercase btn modal-trigger" href="#" onclick="show_login_panel()" data-modal-index="0"><span class="btn__text">Sign in</span></a>',
                        html = $.parseHTML( str ),
                        nodeNames = [];
                        $log.append( html );
                        
                        var $log = $( "#apply_button"),
                        no_apply = '<a class="btn btn-danger type--uppercase" onclick="show_login_panel();"><span class="btn__text">Apply</span></a>'
                        html = $.parseHTML( no_apply ),
                        nodeNames = [];
                        $log.append( html );
                    }
                    else
                    {
                        get_current_user(current_token)
                        var $log = $( "#apply_button"),
                        no_apply = '<a id="apply_btn" class="btn btn-apply type--uppercase" onclick="" ><span class="btn__text">Apply</span></a>'
                        html = $.parseHTML( no_apply ),
                        nodeNames = [];
                        $log.append( html );
                    }


                }
            
           
            window.onload = main;
            
            
            $(window).scroll(function() {
               if($(window).scrollTop() + $(window).height() > $(document).height() - 450) {
                   if(loading_opps != true && more_opps_available == true){
                       fetch_more_opps();
                       loading_opps = true;
                   }
               }
            });
            
        
        </script>
    <script>
        var btn = document.getElementById("goRegister");
        btn.onclick = function() {
            
            var win = window.open('https://auth.aiesec.org/users/sign_in','Create Account','height=500,width=400,left=100,top=100,resizable=yes,scrollbars=yes,toolbar=yes,menubar=no,location=no,directories=no, status=yes');
            
        }

        </script>
        <script src="js/jquery-3.1.1.min.js"></script>
        <script src="js/flickity.min.js"></script>
        <script src="js/easypiechart.min.js"></script>
        <script src="js/parallax.js"></script>
        <script src="js/typed.min.js"></script>
        <script src="js/datepicker.js"></script>
        <script src="js/isotope.min.js"></script>
        <script src="js/ytplayer.min.js"></script>
        <script src="js/lightbox.min.js"></script>
        <script src="js/granim.min.js"></script>
        <script src="js/jquery.steps.min.js"></script>
        <script src="js/countdown.min.js"></script>
        <script src="js/twitterfetcher.min.js"></script>
        <script src="js/spectragram.min.js"></script>
        <script src="js/smooth-scroll.min.js"></script>
        <script src="js/scripts.js"></script>
        <script>
        
        
        
        </script>
    </body>
</html>